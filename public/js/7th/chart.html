<html>

<head>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script type="text/javascript">

    let chartData = [
      ["User", "Points"] // drawChart()속의 data 변수에 들어가는 값
    ];

    const xhtp = new XMLHttpRequest;
    xhtp.open('get', 'http://localhost:3000/points'); // user들의 point 값 불러오기
    xhtp.send();
 
    xhtp.onload = function () { // user들의 point 값을 JSON 형식의 문자열 데이터를 자바스크립트 객체로 변환
      let result = JSON.parse(xhtp.responseText);
      result.forEach(item => {
        chartData.push([item.id, item.point]);
      });
      // console.log(chartData);

      google.charts.load('current', {
        'packages': ['corechart']
      });
      google.charts.setOnLoadCallback(drawChart);
    };

    function drawChart() {
      var data = google.visualization.arrayToDataTable(chartData);

      /*
      그냥 삭제하기 아까워서 주석 처리해 논 것이니 신경쓰지 말기
      [['Task', 'Hours per Day'],
      ['Work', 11],
      ['Eat', 10],
      ['Commute', 2],
      ['Watch TV', 2],
      ['Sleep', 7],
      ['game', 4]]
      */

      var options = {
        title: 'My Daily Activities'
      };

      var chart = new google.visualization
        .PieChart(document.getElementById('piechart'));

      chart.draw(data, options);
    }
  </script>
</head>

<body>
  <div id="piechart" style="width: 900px; height: 500px;"></div>
</body>

</html>